# YOLOv8 Dental Caries Detection

Fine-tuning **YOLOv8** on a **dental X-ray dataset** (Roboflow) to automatically detect tooth caries and export predictions as JSON for integration into a screening app.

[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/<your-username>/yolov8-dental-caries-detection/blob/main/01_yolo_caries_roboflo.ipynb)

---

## Project Overview

Early detection of dental caries usually requires a dentist and a clinical environment.  
The goal of this project is to:

- Train a **YOLOv8 object detection model** to localize caries on dental images.
- Evaluate its performance using standard metrics (**Precision, Recall, mAP50, mAP50–95**).
- Export predictions in a **structured JSON format** so they can be consumed by an external app (for example: mobile app, web demo, or API).

This repository mainly revolves around a single notebook:

- `01_yolo_caries_roboflo.ipynb` – end-to-end training, evaluation and export pipeline.

---

## Main Features

- Fine-tuning YOLOv8 on a custom dental caries dataset.
- Roboflow integration to download the annotated dataset.
- Training and validation with live metrics and plots.
- Evaluation with:
  - Precision
  - Recall
  - mAP@0.50
  - mAP@0.50–0.95
- Prediction export to JSON (boxes, scores, image metadata).
- Visualization of predictions with bounding boxes for quick qualitative inspection.

---

## Dataset

- Source: Roboflow (dental X-ray / intraoral images annotated with caries bounding boxes).
- Format: YOLOv8-compatible dataset (images + `.txt` annotation files).

Note: To run the notebook end-to-end, you will need your own Roboflow API key and project link.

In the notebook, replace the dataset URL / API key with your own:

```python
ROBOFLOW_API_KEY = "YOUR_API_KEY"
ROBOFLOW_WORKSPACE = "YOUR_WORKSPACE"
ROBOFLOW_PROJECT = "YOUR_PROJECT"
ROBOFLOW_VERSION = 1
```

---

## Environment and Installation

You can run everything directly on Google Colab (recommended), or locally.

### Option 1 – Google Colab

1. Open the notebook with the Colab badge above.
2. Make sure the runtime type is:
   - GPU enabled (Runtime > Change runtime type > GPU).
3. Run the cells in order.

All dependencies (including `ultralytics`) are installed inside the notebook.

### Option 2 – Local Setup

```bash
git clone https://github.com/<your-username>/yolov8-dental-caries-detection.git
cd yolov8-dental-caries-detection

# (Optional) create a virtual environment
python -m venv .venv
source .venv/bin/activate  # on Windows: .venv\Scriptsctivate

pip install --upgrade pip
pip install ultralytics roboflow opencv-python matplotlib numpy
```

Then open the notebook with Jupyter or VS Code and run it.

---

## Training Pipeline

The notebook follows this general flow:

1. Setup  
   - Install dependencies (Ultralytics YOLOv8, Roboflow, etc.).
   - Configure paths and environment.

2. Download Dataset  
   - Pull the dataset from Roboflow.
   - Inspect a few images and labels to ensure everything looks correct.

3. Train YOLOv8  
   - Load a YOLOv8 base model (e.g. `yolov8n.pt` or `yolov8s.pt`).
   - Fine-tune on the dental caries dataset using a training command like:

   ```python
   from ultralytics import YOLO

   model = YOLO("yolov8n.pt")  # or 'yolov8s.pt'
   model.train(
       data="data.yaml",      # path generated by Roboflow
       epochs=EPOCHS,
       imgsz=IMG_SIZE,
       batch=BATCH_SIZE
   )
   ```

4. Evaluate  
   - Run validation on the test/validation set.
   - Display metrics and plots (PR curves, confusion matrix, examples).

5. Inference and Visualization  
   - Run inference on sample images.
   - Draw bounding boxes and class labels for visual inspection.

6. Export Predictions to JSON  
   - For each image, export:
     - Bounding box coordinates
     - Confidence scores
     - Class labels
     - Image filename / ID

   The JSON can then be integrated in a separate app or pipeline.

---

## Results

On the held-out evaluation set, the model reaches metrics around:

- Precision (P): 0.805  
- Recall (R): 0.742  
- mAP@0.50: 0.802  
- mAP@0.50–0.95: 0.524  

(on 206 images and 512 instances)

These numbers may change slightly depending on the dataset version, train/val split, and hyperparameters.

---

## JSON Export Format

The exported predictions (per image) follow a structure similar to:

```json
{
  "image_id": "example_001.png",
  "width": 1024,
  "height": 1024,
  "predictions": [
    {
      "class": "caries",
      "confidence": 0.91,
      "bbox": {
        "x_min": 120,
        "y_min": 250,
        "x_max": 180,
        "y_max": 310
      }
    }
  ]
}
```

You can adapt the keys to match your app’s needs (for example, for a mobile or web screening interface).

---

## Repository Structure

```text
.
├── 01_yolo_caries_roboflo.ipynb   # Main Colab / Jupyter notebook
├── README.md                      # This file
└── (optional) /runs               # YOLO training outputs (created after training)
```

---

## Next Steps / Roadmap

Possible improvements:

- Hyperparameter tuning (learning rate, augmentations, etc.).
- Train larger YOLOv8 variants (e.g. `yolov8m`, `yolov8l`) and compare.
- Add segmentation models to detect the exact shape of lesions.
- Build a small web demo or API using the exported JSON predictions.
- Evaluate on external or real-world clinical data.

---

## Contact

If you have questions, suggestions, or want to collaborate:

- Author: Yacine B.  
- GitHub: [@your-username](https://github.com/your-username)

Feel free to open an issue or a pull request.
